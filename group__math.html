<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KTH framework for Nek5000 toolboxes; testing version: Math</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KTH framework for Nek5000 toolboxes; testing version
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__math.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Math<div class="ingroups"><a class="el" href="group__framework.html">Framework for Nek5000 toolboxes</a> &raquo; <a class="el" href="group__toolbox.html">Toolbox</a> &raquo; <a class="el" href="group__utility.html">Utility module</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Diverse tools for matht or data operations.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Math:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__math.png" border="0" usemap="#agroup____math" alt=""/></div>
<map name="agroup____math" id="agroup____math">
<area shape="rect" title="Diverse tools for matht or data operations." alt="" coords="168,5,223,31"/>
<area shape="rect" href="group__utility.html" title="Diverse utilities for toolboxes." alt="" coords="5,5,120,31"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:math__tools_8f"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="math__tools_8f.html">math_tools.f</a></td></tr>
<tr class="memdesc:math__tools_8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set of math related tools for KTH modules. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa7c1f4bb3bbf6134316321bc1f64367f"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__math.html#gaa7c1f4bb3bbf6134316321bc1f64367f">math_stepf</a> (x)</td></tr>
<tr class="memdesc:gaa7c1f4bb3bbf6134316321bc1f64367f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Step function.  <a href="group__math.html#gaa7c1f4bb3bbf6134316321bc1f64367f">More...</a><br /></td></tr>
<tr class="separator:gaa7c1f4bb3bbf6134316321bc1f64367f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae47271fcf38645ea37f078a61137afa6"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__math.html#gae47271fcf38645ea37f078a61137afa6">math_ran_dst</a> (ix, iy, iz, ieg, xl, fcoeff)</td></tr>
<tr class="memdesc:gae47271fcf38645ea37f078a61137afa6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Give random distribution depending on position.  <a href="group__math.html#gae47271fcf38645ea37f078a61137afa6">More...</a><br /></td></tr>
<tr class="separator:gae47271fcf38645ea37f078a61137afa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafdfe84686da6648a4c00f49b588586c3"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__math.html#gafdfe84686da6648a4c00f49b588586c3">math_ran_rng</a> (lower, upper)</td></tr>
<tr class="memdesc:gafdfe84686da6648a4c00f49b588586c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Give random number in the defined range.  <a href="group__math.html#gafdfe84686da6648a4c00f49b588586c3">More...</a><br /></td></tr>
<tr class="separator:gafdfe84686da6648a4c00f49b588586c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9f2bb8e84aba456086ffc193a810a664"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__math.html#ga9f2bb8e84aba456086ffc193a810a664">math_zbqlu01</a> ()</td></tr>
<tr class="memdesc:ga9f2bb8e84aba456086ffc193a810a664"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marsaglia-Zaman random number generator.  <a href="group__math.html#ga9f2bb8e84aba456086ffc193a810a664">More...</a><br /></td></tr>
<tr class="separator:ga9f2bb8e84aba456086ffc193a810a664"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23132f7174dc96fb527ae9d48a3bb930"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__math.html#ga23132f7174dc96fb527ae9d48a3bb930">math_zbqlini</a> (seed)</td></tr>
<tr class="memdesc:ga23132f7174dc96fb527ae9d48a3bb930"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise Marsaglia-Zaman random number generator.  <a href="group__math.html#ga23132f7174dc96fb527ae9d48a3bb930">More...</a><br /></td></tr>
<tr class="separator:ga23132f7174dc96fb527ae9d48a3bb930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadccfbc20f9594206eb9487e35c9219cd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__math.html#gadccfbc20f9594206eb9487e35c9219cd">math_edgind</a> (istart, istop, iskip, iedg, nx, ny, nz)</td></tr>
<tr class="memdesc:gadccfbc20f9594206eb9487e35c9219cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Give bounds for loops to extract edge of a 3D element.  <a href="group__math.html#gadccfbc20f9594206eb9487e35c9219cd">More...</a><br /></td></tr>
<tr class="separator:gadccfbc20f9594206eb9487e35c9219cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga02eb40bed26d98d5ee0ff81595c927d4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__math.html#ga02eb40bed26d98d5ee0ff81595c927d4">math_etovec</a> (vec, edg, vfld, nx, ny, nz)</td></tr>
<tr class="memdesc:ga02eb40bed26d98d5ee0ff81595c927d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract 3D element edge.  <a href="group__math.html#ga02eb40bed26d98d5ee0ff81595c927d4">More...</a><br /></td></tr>
<tr class="separator:ga02eb40bed26d98d5ee0ff81595c927d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b24319b0444a916f0a85e2160879724"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__math.html#ga7b24319b0444a916f0a85e2160879724">math_rot3da</a> (vo, vi, va, an)</td></tr>
<tr class="memdesc:ga7b24319b0444a916f0a85e2160879724"><td class="mdescLeft">&#160;</td><td class="mdescRight">3D rotation of a vector along given axis.  <a href="group__math.html#ga7b24319b0444a916f0a85e2160879724">More...</a><br /></td></tr>
<tr class="separator:ga7b24319b0444a916f0a85e2160879724"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Diverse tools for matht or data operations. </p>
<p>Set of math related routines for toolbox</p>
<dl class="section user"><dt>Module interface:</dt><dd></dd></dl>
<dl class="interface_list_page"><dt><b><a class="el" href="interface_list_page.html#_interface_list_page000023">Global interface list:</a></b></dt><dd>Interface provided:<ol type="1">
<li><a class="el" href="group__math.html#gaa7c1f4bb3bbf6134316321bc1f64367f">math_stepf</a></li>
<li><a class="el" href="group__math.html#gae47271fcf38645ea37f078a61137afa6">math_ran_dst</a></li>
<li><a class="el" href="group__math.html#gafdfe84686da6648a4c00f49b588586c3">math_ran_rng</a></li>
<li><a class="el" href="group__math.html#ga9f2bb8e84aba456086ffc193a810a664">math_zbqlu01</a></li>
<li><a class="el" href="group__math.html#ga23132f7174dc96fb527ae9d48a3bb930">math_zbqlini</a></li>
<li><a class="el" href="group__math.html#gadccfbc20f9594206eb9487e35c9219cd">math_edgind</a></li>
<li><a class="el" href="group__math.html#ga02eb40bed26d98d5ee0ff81595c927d4">math_etovec</a></li>
<li><a class="el" href="group__math.html#ga7b24319b0444a916f0a85e2160879724">math_rot3da</a></li>
</ol>
</dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="gadccfbc20f9594206eb9487e35c9219cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadccfbc20f9594206eb9487e35c9219cd">&#9670;&nbsp;</a></span>math_edgind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine math_edgind </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>istart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>istop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iskip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iedg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Give bounds for loops to extract edge of a 3D element. </p>
<dl class="section note"><dt>Note</dt><dd>All edge related routines used IXCN and ESKIP, but this caused some problems as these arrays have to be continuosly updated for different levels in pressure solver, so I add this routine. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">istart</td><td>lower loop bound </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">istop</td><td>upper loop bound </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">iskip</td><td>stride </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iedg</td><td>edge number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx,ny,nz</td><td>element size </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math__tools_8f_source.html#l00252">252</a> of file <a class="el" href="math__tools_8f_source.html">math_tools.f</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__math_gadccfbc20f9594206eb9487e35c9219cd_icgraph.png" border="0" usemap="#agroup__math_gadccfbc20f9594206eb9487e35c9219cd_icgraph" alt=""/></div>
<map name="agroup__math_gadccfbc20f9594206eb9487e35c9219cd_icgraph" id="agroup__math_gadccfbc20f9594206eb9487e35c9219cd_icgraph">
<area shape="rect" title="Give bounds for loops to extract edge of a 3D element." alt="" coords="551,5,657,32"/>
<area shape="rect" href="group__math.html#ga02eb40bed26d98d5ee0ff81595c927d4" title="Extract 3D element edge." alt="" coords="396,5,503,32"/>
<area shape="rect" href="group__gsyem.html#ga81cd74a24cd24a30c3ca329fed5b78b4" title="Generate family information." alt="" coords="205,5,348,32"/>
<area shape="rect" href="group__gsyem.html#ga8a102e9ce6a4aefd12f8103c3ebf397e" title="Generate mesh dependent information." alt="" coords="5,5,157,32"/>
</map>
</div>

</div>
</div>
<a id="ga02eb40bed26d98d5ee0ff81595c927d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga02eb40bed26d98d5ee0ff81595c927d4">&#9670;&nbsp;</a></span>math_etovec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine math_etovec </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nx)&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>edg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nx*ny*nz)&#160;</td>
          <td class="paramname"><em>vfld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract 3D element edge. </p>
<dl class="section note"><dt>Note</dt><dd>This routine works on singe element not the whole field. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">vec</td><td>vector containg edge values </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">edg</td><td>edge number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vfld</td><td>pointer to singe element in the field </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx,ny,nz</td><td>element size </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math__tools_8f_source.html#l00298">298</a> of file <a class="el" href="math__tools_8f_source.html">math_tools.f</a>.</p>

<p class="reference">References <a class="el" href="math__tools_8f_source.html#l00253">math_edgind()</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__math_ga02eb40bed26d98d5ee0ff81595c927d4_cgraph.png" border="0" usemap="#agroup__math_ga02eb40bed26d98d5ee0ff81595c927d4_cgraph" alt=""/></div>
<map name="agroup__math_ga02eb40bed26d98d5ee0ff81595c927d4_cgraph" id="agroup__math_ga02eb40bed26d98d5ee0ff81595c927d4_cgraph">
<area shape="rect" title="Extract 3D element edge." alt="" coords="5,5,112,32"/>
<area shape="rect" href="group__math.html#gadccfbc20f9594206eb9487e35c9219cd" title="Give bounds for loops to extract edge of a 3D element." alt="" coords="160,5,267,32"/>
</map>
</div>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__math_ga02eb40bed26d98d5ee0ff81595c927d4_icgraph.png" border="0" usemap="#agroup__math_ga02eb40bed26d98d5ee0ff81595c927d4_icgraph" alt=""/></div>
<map name="agroup__math_ga02eb40bed26d98d5ee0ff81595c927d4_icgraph" id="agroup__math_ga02eb40bed26d98d5ee0ff81595c927d4_icgraph">
<area shape="rect" title="Extract 3D element edge." alt="" coords="539,5,645,32"/>
<area shape="rect" href="group__gsyem.html#ga81cd74a24cd24a30c3ca329fed5b78b4" title="Generate family information." alt="" coords="348,5,491,32"/>
<area shape="rect" href="group__gsyem.html#ga8a102e9ce6a4aefd12f8103c3ebf397e" title="Generate mesh dependent information." alt="" coords="148,5,300,32"/>
<area shape="rect" href="group__gsyem.html#ga73294eaccf8e6a4700f60e62754c5a30" title="Initilise gSyEM module." alt="" coords="5,5,100,32"/>
</map>
</div>

</div>
</div>
<a id="gae47271fcf38645ea37f078a61137afa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae47271fcf38645ea37f078a61137afa6">&#9670;&nbsp;</a></span>math_ran_dst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function math_ran_dst </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ieg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ldim)&#160;</td>
          <td class="paramname"><em>xl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(3)&#160;</td>
          <td class="paramname"><em>fcoeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Give random distribution depending on position. </p>
<p>The original Nek5000 random number generator is implementted in <a class="el" href="navier5_8f.html#ad748dfe473aa1c135863bd7d04faf536">ran1</a>. This totally ad-hoc random number generator below could be preferable to the original one for the simple reason that it gives the same initial cindition independent of the number of processors, which is important for code verification. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ix,iy,iz</td><td>GLL point index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ieg</td><td>global element number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xl</td><td>physical point coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcoeff</td><td>function coefficients </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>random distribution </dd></dl>

<p class="definition">Definition at line <a class="el" href="math__tools_8f_source.html#l00054">54</a> of file <a class="el" href="math__tools_8f_source.html">math_tools.f</a>.</p>

</div>
</div>
<a id="gafdfe84686da6648a4c00f49b588586c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafdfe84686da6648a4c00f49b588586c3">&#9670;&nbsp;</a></span>math_ran_rng()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function math_ran_rng </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>lower</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>upper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Give random number in the defined range. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lower,upper</td><td>range for random numer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>random number in the defined range </dd></dl>

<p class="definition">Definition at line <a class="el" href="math__tools_8f_source.html#l00081">81</a> of file <a class="el" href="math__tools_8f_source.html">math_tools.f</a>.</p>

<p class="reference">References <a class="el" href="math__tools_8f_source.html#l00120">math_zbqlu01()</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__math_gafdfe84686da6648a4c00f49b588586c3_cgraph.png" border="0" usemap="#agroup__math_gafdfe84686da6648a4c00f49b588586c3_cgraph" alt=""/></div>
<map name="agroup__math_gafdfe84686da6648a4c00f49b588586c3_cgraph" id="agroup__math_gafdfe84686da6648a4c00f49b588586c3_cgraph">
<area shape="rect" title="Give random number in the defined range." alt="" coords="5,5,117,32"/>
<area shape="rect" href="group__math.html#ga9f2bb8e84aba456086ffc193a810a664" title="Marsaglia&#45;Zaman random number generator." alt="" coords="165,5,280,32"/>
</map>
</div>

</div>
</div>
<a id="ga7b24319b0444a916f0a85e2160879724"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7b24319b0444a916f0a85e2160879724">&#9670;&nbsp;</a></span>math_rot3da()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine math_rot3da </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ldim)&#160;</td>
          <td class="paramname"><em>vo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ldim)&#160;</td>
          <td class="paramname"><em>vi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ldim)&#160;</td>
          <td class="paramname"><em>va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>an</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>3D rotation of a vector along given axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vo</td><td>output vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vi</td><td>input vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">va</td><td>rotation axis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">an</td><td>rotation angle </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="math__tools_8f_source.html#l00331">331</a> of file <a class="el" href="math__tools_8f_source.html">math_tools.f</a>.</p>

<p class="reference">References <a class="el" href="math_8f_source.html#l00260">copy()</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__math_ga7b24319b0444a916f0a85e2160879724_cgraph.png" border="0" usemap="#agroup__math_ga7b24319b0444a916f0a85e2160879724_cgraph" alt=""/></div>
<map name="agroup__math_ga7b24319b0444a916f0a85e2160879724_cgraph" id="agroup__math_ga7b24319b0444a916f0a85e2160879724_cgraph">
<area shape="rect" title="3D rotation of a vector along given axis." alt="" coords="5,5,111,32"/>
<area shape="rect" href="math_8f.html#a3b43508554f14bdea8e14473d7d0803c" title=" " alt="" coords="159,5,212,32"/>
</map>
</div>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__math_ga7b24319b0444a916f0a85e2160879724_icgraph.png" border="0" usemap="#agroup__math_ga7b24319b0444a916f0a85e2160879724_icgraph" alt=""/></div>
<map name="agroup__math_ga7b24319b0444a916f0a85e2160879724_icgraph" id="agroup__math_ga7b24319b0444a916f0a85e2160879724_icgraph">
<area shape="rect" title="3D rotation of a vector along given axis." alt="" coords="539,31,644,57"/>
<area shape="rect" href="group__gsyem.html#ga81cd74a24cd24a30c3ca329fed5b78b4" title="Generate family information." alt="" coords="348,5,491,32"/>
<area shape="rect" href="group__tripl.html#gafa9770b465a7ed852f178de153efa435" title="Initilise tripping module." alt="" coords="381,56,457,83"/>
<area shape="rect" href="group__gsyem.html#ga8a102e9ce6a4aefd12f8103c3ebf397e" title="Generate mesh dependent information." alt="" coords="148,5,300,32"/>
<area shape="rect" href="group__gsyem.html#ga73294eaccf8e6a4700f60e62754c5a30" title="Initilise gSyEM module." alt="" coords="5,5,100,32"/>
</map>
</div>

</div>
</div>
<a id="gaa7c1f4bb3bbf6134316321bc1f64367f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa7c1f4bb3bbf6134316321bc1f64367f">&#9670;&nbsp;</a></span>math_stepf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function math_stepf </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Step function. </p>
<p>Continuous step function: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} stepf(x) = \left\{ \begin{array}{ll} 0 &amp;\mbox{ if $x \leq x_{min}$} \\ \left(1+e^{\left((x-1)^{-1} + x^{-1}\right)}\right)^{-1} &amp;\mbox{ if $x \leq x_{max}$} \\ 1 &amp;\mbox{ if $x &gt; x_{max}$} \end{array} \right. \end{eqnarray*}" src="form_39.png" width="288" height="54"/>
</p>
<p> with <img class="formulaInl" alt="$ x_{min} = 0.0001$" src="form_40.png" width="79" height="11"/> and <img class="formulaInl" alt="$ x_{max}=0.9999$" src="form_41.png" width="80" height="11"/> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>function argument </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>math_stepf </dd></dl>

<p class="definition">Definition at line <a class="el" href="math__tools_8f_source.html#l00020">20</a> of file <a class="el" href="math__tools_8f_source.html">math_tools.f</a>.</p>

</div>
</div>
<a id="ga23132f7174dc96fb527ae9d48a3bb930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga23132f7174dc96fb527ae9d48a3bb930">&#9670;&nbsp;</a></span>math_zbqlini()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine math_zbqlini </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise Marsaglia-Zaman random number generator. </p>
<p>To initialise the random number generator - either repeatably or nonrepeatably. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seed</td><td>number which generates elements of the array ZBQLIX </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000018">Todo:</a></b></dt><dd>Remove all common blocks and save variables to make it possible to be used by multiple tools </dd></dl>

<p class="definition">Definition at line <a class="el" href="math__tools_8f_source.html#l00179">179</a> of file <a class="el" href="math__tools_8f_source.html">math_tools.f</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__math_ga23132f7174dc96fb527ae9d48a3bb930_icgraph.png" border="0" usemap="#agroup__math_ga23132f7174dc96fb527ae9d48a3bb930_icgraph" alt=""/></div>
<map name="agroup__math_ga23132f7174dc96fb527ae9d48a3bb930_icgraph" id="agroup__math_ga23132f7174dc96fb527ae9d48a3bb930_icgraph">
<area shape="rect" title="Initialise Marsaglia&#45;Zaman random number generator." alt="" coords="148,5,255,32"/>
<area shape="rect" href="group__gsyem.html#ga73294eaccf8e6a4700f60e62754c5a30" title="Initilise gSyEM module." alt="" coords="5,5,100,32"/>
</map>
</div>

</div>
</div>
<a id="ga9f2bb8e84aba456086ffc193a810a664"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9f2bb8e84aba456086ffc193a810a664">&#9670;&nbsp;</a></span>math_zbqlu01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function math_zbqlu01</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Marsaglia-Zaman random number generator. </p>
<p>Returns a uniform random number between 0 &amp; 1, using a Marsaglia-Zaman type subtract-with-borrow generator. </p><dl class="section remark"><dt>Remarks</dt><dd>Uses double precision, rather than integer, arithmetic throughout because MZ's INTEGER constants overflow 32-bit INTEGER storage (which goes from -2^31 to 2^31). Ideally, we would explicitly truncate all INTEGER quantities at each stage to ensure that the DOUBLE PRECISION representations DO not accumulate approximation error; however, on some machines the USE of DNINT to accomplish this is <em>seriously</em> slow (run-time increased by a factor of about 3). This DOUBLE PRECISION version has been tested against an INTEGER implementation that uses long integers (non-standard and, again, slow) - the output was identical up to the 16th decimal place after 10^10 calls, so we're probably OK ... In current implementation we follow Nek5000 compilation rulles prolonging all reals to doulbe with compiler flaggs. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Richard Chandler (<a href="#" onclick="location.href='mai'+'lto:'+'ric'+'ha'+'rd@'+'st'+'ats'+'.u'+'cl.'+'ac'+'.uk'; return false;">richa<span style="display: none;">.nosp@m.</span>rd@s<span style="display: none;">.nosp@m.</span>tats.<span style="display: none;">.nosp@m.</span>ucl.<span style="display: none;">.nosp@m.</span>ac.uk</a>) </dd>
<dd>
Paul Northrop (<a href="#" onclick="location.href='mai'+'lto:'+'nor'+'th'+'rop'+'@s'+'tat'+'s.'+'ox.'+'ac'+'.uk'; return false;">north<span style="display: none;">.nosp@m.</span>rop@<span style="display: none;">.nosp@m.</span>stats<span style="display: none;">.nosp@m.</span>.ox.<span style="display: none;">.nosp@m.</span>ac.uk</a>) </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>random number </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000017">Todo:</a></b></dt><dd>Remove all common blocks and save variables to make it possible to be used by multiple tools </dd></dl>

<p class="definition">Definition at line <a class="el" href="math__tools_8f_source.html#l00119">119</a> of file <a class="el" href="math__tools_8f_source.html">math_tools.f</a>.</p>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__math_ga9f2bb8e84aba456086ffc193a810a664_icgraph.png" border="0" usemap="#agroup__math_ga9f2bb8e84aba456086ffc193a810a664_icgraph" alt=""/></div>
<map name="agroup__math_ga9f2bb8e84aba456086ffc193a810a664_icgraph" id="agroup__math_ga9f2bb8e84aba456086ffc193a810a664_icgraph">
<area shape="rect" title="Marsaglia&#45;Zaman random number generator." alt="" coords="165,5,280,32"/>
<area shape="rect" href="group__math.html#gafdfe84686da6648a4c00f49b588586c3" title="Give random number in the defined range." alt="" coords="5,5,117,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Aug 29 2023 10:19:33 for KTH framework for Nek5000 toolboxes; testing version by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
