<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KTH framework for Nek5000 toolboxes; testing version: Setting up the case.</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KTH framework for Nek5000 toolboxes; testing version
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('compilation_page.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Setting up the case. </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The creation of a Nek5000 setup using the framework starts with collecting information about required modules and their dependencies. The most important is a list of provided and required interfaces for each of the modules. With a complete list of required modules, the user can build the setup's <em>makefile_usr.inc</em> concatenating corresponding files from modules' home directories in the toolbox. Next, the <em>compile_script</em> has to be generated and all the object files from <em>makefile_usr.inc</em> have to be included in <em>USR</em> variable. Please observe that the compilation script has to contain a call to <em>toolbox_path.sh</em>. To make a source code complete one has to copy all the template Fortran77 include-files from the modules' home directories to the setup directory, dropping the <em>_template</em> extension. The content of these files has to be checked and adjusted to the case needs. Next, the calls to the appropriate interfaces of the used modules have to be added to <em>###</em>.usr file. Most of them should be added to the <em>userchk</em> subroutine, although in specific cases the other subroutines could be used as well. The most basic ones are calls to <a class="el" href="group__frame.html#ga3b2fa5ca96c4d901949ed15b9e1e459c">frame_start</a>, <a class="el" href="group__frame.html#ga3100879c73f67d2e4449da55049c8eae">frame_monitor</a> and <a class="el" href="group__frame.html#ga81cd9de9df55590aae9e54090dd1a3ce">frame_end</a> subroutines, which are interfaces of the <a class="el" href="group__frame.html">Frame module</a> module.</p>
<p>The last step before the compilation of the code is the generation of the user interfaces required by the used modules. The templates of these subroutines can be found in <em>example.usr</em> files in modules' directories, but they should not be used directly without proper modification. Although this step is very case-dependent, the <a class="el" href="group__frame.html">Frame module</a> module is obligatory, so at least three user subroutines have to be added to the <em>###</em>.usr file. These are <em>frame_usr_register</em>, <em>frame_usr_init</em> and <em>frame_usr_end</em>. They should contain calls to the modules' registration, initialisation and finalisation routines respectively, and are required by <a class="el" href="group__frame.html#ga3b2fa5ca96c4d901949ed15b9e1e459c">frame_start</a> and <a class="el" href="group__frame.html#ga81cd9de9df55590aae9e54090dd1a3ce">frame_end</a> subroutines.</p>
<p>To execute the code one needs the run-time parameter file <em>###</em>.par which can be build based on <em>example.par</em> files located in modules' directories. Notice that these files contain module-specific parameter sections, so the general Nek5000 run-time parameters have to be added separately. Like all the other run-time parameters in Nek5000, the run-time parameters defined in the framework come with a default value and only those modified have to be present in the <em>###</em>.par file. For the log level smaller or equal <em>lp_prd</em> (6) the list of all the registered framework run-time parameters can be found in the log file. We have to stress here, that the framework does not support the legacy run-time parameter file <em>###</em>.rea.</p>
<p>For more details, the user is directed to <em>KTH_Examples</em> repository containing examples of all the existing tools in the framework. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Aug 29 2023 10:19:33 for KTH framework for Nek5000 toolboxes; testing version by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
